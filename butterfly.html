<!DOCTYPE html>
<html lang="en">
   <head>
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="js/contour.js"></script>
    <meta charset="utf-8"/>
    <title>D3 Convex Hull</title>
  </head>
  <body>
    <h1>D3 Convex Hull</h1>
    <div id="polygon_div">
      <svg id="polygon"></svg>
    </div>
  </body>
  
  <script>
    const width = 800;
    const height = 600;

    // sample size
    const n = 100;
    let values = new Array(n);
    for(let i = 0; i < n; i++) {
      values[i] = {
        "x": d3.randomNormal(width / 2, width / 7)(),
        "y": d3.randomNormal(height / 2, height / 7)()
      };
    }

    let svg = d3.select("#polygon").attr("width", width).attr("height", height);

    let xScale = d3.scaleLinear()
      .domain([0, width])
      .rangeRound([0, width]);

    let yScale = d3.scaleLinear()
      .domain([height, 0])
      .rangeRound([height, 0]);

    let vertices = values.map(function(d) { return [xScale(d["x"]), yScale(d["y"])]; });
    let polygon = d3.polygonHull(vertices);

    // add convex hull
    svg.append("g")
      .append("path")
      .datum(polygon)
      .attr("id", "convex_hull")
      .attr("d", function(d) { return "M" + d.join("L") + "Z"; })
      .attr("fill", "cyan")
      .attr("stroke", "steelblue")
      .attr("opacity", "0.5");

    let centroid = d3.polygonCentroid(polygon);
    svg.append("g")
      .append("circle")
      .attr("cx", function(d) { return centroid[0]; })
      .attr("cy", function(d) { return centroid[1]; })
      .attr("r", 2)
      .attr("fill", "red");

    // plot data points
    svg.append("g")
      .selectAll("circle")
      .data(values)
      .enter().append("circle")
      .attr("cx", function(d) { return xScale(d["x"]); })
      .attr("cy", function(d) { return yScale(d["y"]); })
      .attr("r", 2);

</script>
